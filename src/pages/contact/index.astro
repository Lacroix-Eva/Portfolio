---
import Layout from "../../layouts/Layout.astro";
---

<Layout
  nomPage="Contact"
  description="Contactez-moi pour discuter d'une opportunité de stage ou d'alternance dans les domaines du digital, du design ou de la communication."
>
  <main class="px-5 lg:px-20 py-10">
    <h2 class="mb-6 text-center">Envie de collaborer avec moi ?</h2>

    <p class="text-center mb-10 opacity-80 w-500 mx-auto bg-base-100">
      Je suis étudiante en BUT MMI et je recherche une opportunité de
      <strong>stage</strong> ou d’<strong>alternance</strong> pour développer mes
      compétences en design, web et communication. N'hésitez pas à me contacter via
      ce formulaire.
    </p>

    <form
      id="contact-form"
      action="/api/contact"
      method="post"
      enctype="multipart/form-data"
      class="mx-auto max-w-3xl lg:max-w-4xl w-full space-y-10 p-8 md:p-12 rounded-3xl shadow-2xl
         bg-white/5 backdrop-blur-xl border border-white/10 transition-all"
    >
      <!-- Type d'opportunité -->
      <fieldset class="space-y-4">
        <legend class="text-xl font-semibold md:text-2xl lg:text-3xl mb-4">
          Type d'opportunité
        </legend>

        <div class="relative">
          <select
            name="type"
            required
            class="peer w-full h-14 bg-white/5 border border-white/10 rounded-xl px-3
             pr-12 appearance-none text-lg
             focus:border-primary focus:ring-2 focus:ring-primary/40 transition-all"
          >
            <option value="" disabled selected hidden></option>
            <option value="stage" class="text-black">Stage</option>
            <option value="alternance" class="text-black">Alternance</option>
            <option value="autre" class="text-black">Autre proposition</option>
          </select>

          <!-- Label flottant -->
          <label
            class="absolute left-4 top-1 text-base text-white/70 pointer-events-none transition-all mt-1
             peer-focus:text-primary peer-focus:text-sm peer-focus:top-1.5
             peer-valid:opacity-0 peer-valid:translate-y-1 peer-valid:text-transparent"
          >
            Sélection
          </label>

          <!-- Flèche custom -->
          <svg
            class="pointer-events-none absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-white/70
                   peer-focus:text-primary transition-colors"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M19 9l-7 7-7-7"></path>
          </svg>
        </div>

        <!-- Champ "Autre proposition" -->
        <div id="autre-field" class="hidden mt-4">
          <div class="relative">
            <input
              type="text"
              name="autre_details"
              placeholder=" "
              class="auto-grow peer w-full min-h-14 bg-white/5 border border-white/10 rounded-xl px-4 pt-4
                focus:border-primary focus:ring-2 focus:ring-primary/40 transition-all"
            />
            <label
              class="absolute left-4 top-1 text-base text-white/70 pointer-events-none transition-all mt-1
              peer-focus:text-primary peer-focus:text-sm peer-focus:top-1.5
              peer-placeholder-shown:opacity-100 peer-placeholder-shown:translate-y-0
              peer-placeholder-shown:text-white/70
              peer-not-placeholder-shown:opacity-0 peer-not-placeholder-shown:translate-y-1 peer-not-placeholder-shown:text-transparent"
            >
              Précisez votre proposition
            </label>
          </div>
        </div>
      </fieldset>

      <!-- Vos informations -->
      <fieldset>
        <legend class="text-xl font-semibold md:text-2xl lg:text-3xl mb-4">
          Vos informations
        </legend>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <!-- NOM -->
          <div class="relative">
            <textarea
              name="nom"
              required
              placeholder=" "
              class="auto-grow peer w-full min-h-14 bg-white/6 border border-white/10 rounded-xl px-4 pt-4
           focus:border-primary focus:ring-2 focus:ring-primary/40 transition-all
           resize-none overflow-hidden"
            ></textarea>

            <label
              class="absolute left-4 top-1 text-base text-white/70 pointer-events-none transition-all mt-1
           peer-focus:text-primary peer-focus:text-sm peer-focus:top-1.5
           peer-placeholder-shown:opacity-100 peer-placeholder-shown:translate-y-0
           peer-placeholder-shown:text-white/70
           peer-not-placeholder-shown:opacity-0 peer-not-placeholder-shown:translate-y-1
           peer-not-placeholder-shown:text-transparent"
            >
              Nom
            </label>
          </div>

          <!-- ENTREPRISE -->
          <div class="relative">
            <textarea
              name="nom"
              required
              placeholder=" "
              class="auto-grow peer w-full min-h-14 bg-white/6 border border-white/10 rounded-xl px-4 pt-4
           focus:border-primary focus:ring-2 focus:ring-primary/40 transition-all
           resize-none overflow-hidden"
            ></textarea>

            <label
              class="absolute left-4 top-1 text-base text-white/70 pointer-events-none transition-all mt-1
           peer-focus:text-primary peer-focus:text-sm peer-focus:top-1.5
           peer-placeholder-shown:opacity-100 peer-placeholder-shown:translate-y-0
           peer-placeholder-shown:text-white/70
           peer-not-placeholder-shown:opacity-0 peer-not-placeholder-shown:translate-y-1
           peer-not-placeholder-shown:text-transparent"
            >
              Entreprise (facultatif)
            </label>
          </div>

          <!-- EMAIL -->
          <div class="relative">
            <textarea
              name="nom"
              required
              placeholder=" "
              class="auto-grow peer w-full min-h-14 bg-white/6 border border-white/10 rounded-xl px-4 pt-4
           focus:border-primary focus:ring-2 focus:ring-primary/40 transition-all
           resize-none overflow-hidden"
            ></textarea>

            <label
              class="absolute left-4 top-1 text-base text-white/70 pointer-events-none transition-all mt-1
           peer-focus:text-primary peer-focus:text-sm peer-focus:top-1.5
           peer-placeholder-shown:opacity-100 peer-placeholder-shown:translate-y-0
           peer-placeholder-shown:text-white/70
           peer-not-placeholder-shown:opacity-0 peer-not-placeholder-shown:translate-y-1
           peer-not-placeholder-shown:text-transparent"
            >
              Email
            </label>
          </div>

          <!-- TÉLÉPHONE -->
          <div class="relative">
            <textarea
              name="nom"
              required
              placeholder=" "
              class="auto-grow peer w-full min-h-14 bg-white/6 border border-white/10 rounded-xl px-4 pt-4
           focus:border-primary focus:ring-2 focus:ring-primary/40 transition-all
           resize-none overflow-hidden"
            ></textarea>

            <label
              class="absolute left-4 top-1 text-base text-white/70 pointer-events-none transition-all mt-1
           peer-focus:text-primary peer-focus:text-sm peer-focus:top-1.5
           peer-placeholder-shown:opacity-100 peer-placeholder-shown:translate-y-0
           peer-placeholder-shown:text-white/70
           peer-not-placeholder-shown:opacity-0 peer-not-placeholder-shown:translate-y-1
           peer-not-placeholder-shown:text-transparent"
            >
              Téléphone (facultatif)
            </label>
          </div>
        </div>
      </fieldset>

      <!-- Message -->
      <fieldset>
        <legend class="text-xl font-semibold md:text-2xl lg:text-3xl mb-4">
          Message
        </legend>

        <div class="relative">
          <textarea
            name="message"
            required
            placeholder=" "
            class="auto-grow peer w-full bg-white/6 border border-white/10 rounded-xl px-4 pt-4
            focus:border-primary focus:ring-2 focus:ring-primary/40 transition-all
            resize-none overflow-hidden min-h-[8rem]"
          ></textarea>

          <label
            class="absolute left-4 top-1 text-base text-white/70 pointer-events-none transition-all mt-1
            peer-focus:text-primary peer-focus:text-sm peer-focus:top-1.5
            peer-placeholder-shown:opacity-100 peer-placeholder-shown:translate-y-0
            peer-placeholder-shown:text-white/70
            peer-not-placeholder-shown:opacity-0 peer-not-placeholder-shown:translate-y-1 peer-not-placeholder-shown:text-transparent"
          >
            Votre message
          </label>
        </div>
      </fieldset>

      <!-- Pièces jointes -->
      <fieldset>
        <legend class="text-xl font-semibold md:text-2xl lg:text-3xl mb-4">
          Pièces jointes
        </legend>

        <label class="block">
          <input
            type="file"
            name="fichiers"
            multiple
            class="file-input border-r-100 w-full bg-white/6 border border-white/10 rounded-xl"
          />
        </label>
      </fieldset>

      <!-- Bouton -->
      <div class="text-center">
        <button
          type="submit"
          class="btn btn-primary px-10 py-3 rounded-full text-lg shadow-lg hover:shadow-primary/30 transition-all"
        >
          Envoyer
        </button>
      </div>
    </form>

    <div class="mt-20">
      <h2 class="mb-6 text-center">Me contacter directement</h2>
      <div class="space-y-4 text-center">
        <p>
          Email :
          <a href="mailto:lacroixeva32@gmail.com" class="link">
            lacroixeva32@gmail.com
          </a>
        </p>
      </div>
    </div>

    <div class="mt-20">
      <h2 class="mb-6 text-center">Besoin de mon CV ?</h2>
      <div class="text-center flex justify-center gap-4">
        <a
          href="/CV/CV_LACROIX_Eva.pdf"
          target="_blank"
          rel="noopener noreferrer"
          class="btn btn-outline btn-accent"
        >
          Visualiser le CV
        </a>

        <a
          href="/CV/CV_LACROIX_Eva.pdf"
          download="CV_LACROIX_Eva.pdf"
          class="btn btn-secondary"
        >
          Télécharger le CV (PDF)
        </a>
      </div>
    </div>
  </main>
</Layout>

<!-- Script apparition champ "autre" + auto-grow -->
<script>
  const select = document.querySelector('select[name="type"]');
  const autreField = document.getElementById("autre-field");

  select.addEventListener("change", () => {
    autreField.classList.toggle("hidden", select.value !== "autre");
  });

  // Auto-grow pour tous les inputs text + textarea
  const growFields = document.querySelectorAll(".auto-grow");

  growFields.forEach((field) => {
    field.addEventListener("input", () => {
      field.style.height = "auto";
      field.style.height = field.scrollHeight + "px";
    });
  });

  const autoGrowAreas = document.querySelectorAll("textarea");

  autoGrowAreas.forEach((area) => {
    area.addEventListener("input", () => {
      area.style.height = "auto";
      area.style.height = area.scrollHeight + "px";
    });
  });
</script>
