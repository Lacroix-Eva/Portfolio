---
const { item } = Astro.props;
---

<header class="relative flex items-center justify-between lg:m-0 mb-2 lg:mb-0">
  <!-- Logo à gauche -->
  <a href="/" aria-label="Accueil">
    <img
      src="/icons/logoBlanc.png"
      alt="Logo"
      class="w-24 h-24 md:w-32 md:h-32 lg:w-44 lg:h-44"
    />
  </a>

  <!-- Bouton menu à droite -->
  <div class="absolute right-0">
    <button
      id="menu-btn"
      class="focus:outline-none mr-5"
      aria-label="Ouvrir le menu"
      aria-expanded="false"
    >
      <img
        src="/icons/menu.svg"
        alt="Menu"
        class="cursor-pointer
        w-16
        h-16
        md:w-24
        md:h-24
        lg:w-32
        lg:h-32"
      />
    </button>
  </div>

  <!-- Menu latéral -->
  <nav
    id="menu-panel"
    class="fixed top-0 right-0 h-full w-170 max-w-full bg-base-200 translate-x-full
         transition-transform duration-500 ease-[cubic-bezier(.16,1,.3,1)]
         shadow-2xl z-50 border-l border-base-300"
    aria-hidden="true"
    role="dialog"
    aria-label="Menu de navigation"
  >
    <!-- Bouton close -->
    <button
      id="close-menu"
      class="absolute right-6 top-6 lg:right-15 lg:top-10 p-2 rounded-full hover:bg-base-300/40
           transition-colors focus:outline-none focus:ring-2 focus:ring-primary"
      aria-label="Fermer le menu"
    >
      <img
        src="/icons/croix.svg"
        alt=""
        width="72"
        height="72"
        class="w-11 h-11 lg:w-18 lg:h-18 pointer-events-none"
      />
    </button>

    <!-- Liens -->
    <div class="px-16 pt-32">
      <ul class="flex flex-col items-start space-y-16 lg:space-y-20">
        <li>
          <a
            href="/projects"
            class="neon neon-pulse text-5xl md:text-6xl lg:text-7xl font-semibold
                 hover:opacity-75 transition-opacity"
          >
            Projets
          </a>
        </li>

        <li>
          <a
            href="/about"
            class="neon neon-pulse text-5xl md:text-6xl lg:text-7xl font-semibold
                 hover:opacity-75 transition-opacity"
          >
            À propos
          </a>
        </li>

        <li>
          <a
            href="/contact"
            class="neon neon-pulse text-5xl md:text-6xl lg:text-7xl font-semibold
                 hover:opacity-75 transition-opacity"
          >
            Contact
          </a>
        </li>

        <!-- Section secondaire -->
        <li class="pt-10 border-t border-primary/30 w-full">
          <a
            href="/mentions_legales"
            class="neon-petit-texte neon-petit-texte-pulse tracking-wide uppercase text-white/60
                 hover:text-white hover:underline underline-offset-4
                 transition-all duration-200 text-base"
          >
            Mentions légales
          </a>
        </li>
      </ul>
    </div>
  </nav>
</header>

<script>
  const menuBtn = document.getElementById("menu-btn");
  const closeMenu = document.getElementById("close-menu");
  const menuPanel = document.getElementById("menu-panel");

  function openMenu() {
    menuPanel.classList.remove("translate-x-full");
    menuPanel.setAttribute("aria-hidden", "false");
    menuBtn.setAttribute("aria-expanded", "true");
    document.body.classList.add("overflow-hidden"); // empêche le scroll
  }

  function closeMenuPanel() {
    menuPanel.classList.add("translate-x-full");
    menuPanel.setAttribute("aria-hidden", "true");
    menuBtn.setAttribute("aria-expanded", "false");
    document.body.classList.remove("overflow-hidden");
  }

  // Ferme le menu quand on clique n'importe où sur la page,
  // sauf si le clic est sur le bouton du menu ou à l'intérieur du panneau.
  function onDocumentClick(e) {
    if (!menuPanel || !menuBtn) return;
    const isOpen = !menuPanel.classList.contains("translate-x-full");
    if (!isOpen) return;

    const target = e.target;
    if (menuPanel.contains(target) || menuBtn.contains(target)) {
      return; // clic à l'intérieur du panneau ou sur le bouton -> ne pas fermer
    }

    closeMenuPanel();
  }

  if (menuBtn && closeMenu && menuPanel) {
    menuBtn.addEventListener("click", openMenu);
    closeMenu.addEventListener("click", closeMenuPanel);
    document.addEventListener("click", onDocumentClick);
  }
</script>
